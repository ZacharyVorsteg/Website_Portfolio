<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exit Scenario Calculator - IRR/MOIC Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .glass-card {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 300px;
            max-height: 300px;
        }
        .chart-wrapper canvas {
            position: absolute !important;
            top: 0;
            left: 0;
        }
        .info-tooltip {
            position: relative;
            display: inline-block;
        }
        .info-tooltip .tooltip-text {
            visibility: hidden;
            width: 250px;
            background-color: rgba(0, 0, 0, 0.95);
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 50;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen p-4 md:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header [[memory:7788592]] -->
        <div class="glass-card rounded-xl p-6 mb-6">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4">
                <h1 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                    Exit Scenario Calculator
                </h1>
                <span class="inline-block px-3 py-1.5 bg-blue-500/20 text-blue-400 rounded-lg text-sm font-medium">
                    Live Demo
                </span>
            </div>
            <p class="text-gray-400 mb-4">
                Calculate investor returns based on exit multiples and timing. This demo generates IRR/MOIC charts instantly, 
                helping founders and investors understand how different exit scenarios impact returns. Model various exit 
                strategies with multiple investment rounds.
            </p>
            <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 flex items-start gap-2">
                <i data-lucide="info" class="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"></i>
                <div class="text-sm text-gray-300">
                    <strong>How to use:</strong> Input investment details and adjust exit scenarios. The calculator shows 
                    IRR, MOIC, and cash returns for each investor class based on liquidation preferences and ownership.
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Controls -->
            <div class="lg:col-span-1">
                <div class="glass-card rounded-xl p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        <i data-lucide="settings" class="w-5 h-5 text-blue-400"></i>
                        Investment & Exit Parameters
                    </h2>
                    
                    <div class="space-y-4">
                        <!-- Initial Investment -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Initial Investment ($M)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Total capital invested at entry (Series A/B/C).
                                    </span>
                                </div>
                            </label>
                            <input type="number" id="investment" value="10" min="0.5" max="100" step="0.5"
                                   class="w-full bg-white/10 rounded-lg px-3 py-2 text-white"
                                   onchange="calculateReturns()">
                        </div>

                        <!-- Pre-Money Valuation -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Pre-Money Valuation ($M)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Company valuation before investment.
                                    </span>
                                </div>
                            </label>
                            <input type="number" id="preMoney" value="40" min="1" max="1000" step="5"
                                   class="w-full bg-white/10 rounded-lg px-3 py-2 text-white"
                                   onchange="calculateReturns()">
                        </div>

                        <!-- Exit Multiple Range -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Exit Multiple (Revenue)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Exit valuation as multiple of revenue (e.g., 5x revenue).
                                    </span>
                                </div>
                            </label>
                            <input type="range" id="exitMultiple" min="1" max="20" value="8" step="0.5"
                                   class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-gradient-to-r from-blue-500 to-purple-500">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>1x</span>
                                <span id="exitMultipleValue" class="text-blue-400 font-bold">8x</span>
                                <span>20x</span>
                            </div>
                        </div>

                        <!-- Current Revenue -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Current Annual Revenue ($M)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Company's current ARR/revenue run rate.
                                    </span>
                                </div>
                            </label>
                            <input type="number" id="currentRevenue" value="15" min="1" max="500" step="1"
                                   class="w-full bg-white/10 rounded-lg px-3 py-2 text-white"
                                   onchange="calculateReturns()">
                        </div>

                        <!-- Revenue Growth Rate -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Annual Revenue Growth (%)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Expected annual revenue growth rate.
                                    </span>
                                </div>
                            </label>
                            <input type="range" id="growthRate" min="10" max="100" value="40" step="5"
                                   class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-gradient-to-r from-blue-500 to-purple-500">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>10%</span>
                                <span id="growthRateValue" class="text-blue-400 font-bold">40%</span>
                                <span>100%</span>
                            </div>
                        </div>

                        <!-- Exit Timeline -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2 flex items-center gap-2">
                                Exit Timeline (Years)
                                <div class="info-tooltip">
                                    <i data-lucide="help-circle" class="w-3 h-3 text-gray-500 cursor-help"></i>
                                    <span class="tooltip-text">
                                        Years until exit event (IPO/acquisition).
                                    </span>
                                </div>
                            </label>
                            <input type="range" id="exitYears" min="2" max="10" value="5" step="1"
                                   class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-gradient-to-r from-blue-500 to-purple-500">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>2</span>
                                <span id="exitYearsValue" class="text-blue-400 font-bold">5 years</span>
                                <span>10</span>
                            </div>
                        </div>

                        <!-- Liquidation Preference -->
                        <div>
                            <label class="text-sm text-gray-400 mb-2">Liquidation Preference</label>
                            <select id="liquidation" class="w-full bg-white/10 rounded-lg px-3 py-2 text-white"
                                    onchange="calculateReturns()">
                                <option value="1x">1x Non-Participating</option>
                                <option value="1xp">1x Participating</option>
                                <option value="2x">2x Non-Participating</option>
                                <option value="none">No Preference</option>
                            </select>
                        </div>
                    </div>

                    <div class="mt-6 space-y-3">
                        <button onclick="runScenarios()" 
                                class="w-full py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <i data-lucide="play" class="w-4 h-4"></i>
                            Run All Scenarios
                        </button>
                        <button onclick="exportResults()" 
                                class="w-full py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            Export Analysis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Key Metrics -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                    <div class="glass-card rounded-xl p-3">
                        <div class="text-xs text-gray-400 mb-1">Exit Value</div>
                        <div id="exitValue" class="text-lg font-bold text-blue-400">$0M</div>
                        <div id="exitRevenue" class="text-xs text-gray-500">at $0M revenue</div>
                    </div>
                    <div class="glass-card rounded-xl p-3">
                        <div class="text-xs text-gray-400 mb-1">Cash Return</div>
                        <div id="cashReturn" class="text-lg font-bold text-green-400">$0M</div>
                        <div id="profit" class="text-xs text-gray-500">$0M profit</div>
                    </div>
                    <div class="glass-card rounded-xl p-3">
                        <div class="text-xs text-gray-400 mb-1">MOIC</div>
                        <div id="moic" class="text-lg font-bold text-purple-400">0.0x</div>
                        <div class="text-xs text-gray-500">Multiple</div>
                    </div>
                    <div class="glass-card rounded-xl p-3">
                        <div class="text-xs text-gray-400 mb-1">IRR</div>
                        <div id="irr" class="text-lg font-bold text-pink-400">0%</div>
                        <div class="text-xs text-gray-500">Annual</div>
                    </div>
                </div>

                <!-- IRR vs Exit Multiple Chart -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="trending-up" class="w-5 h-5 text-blue-400"></i>
                        IRR vs Exit Multiple
                    </h3>
                    <div class="chart-wrapper">
                        <canvas id="irrChart"></canvas>
                    </div>
                </div>

                <!-- MOIC Scenarios Chart -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="bar-chart-2" class="w-5 h-5 text-purple-400"></i>
                        MOIC by Exit Timeline
                    </h3>
                    <div class="chart-wrapper">
                        <canvas id="moicChart"></canvas>
                    </div>
                </div>

                <!-- Scenario Analysis Table -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="table" class="w-5 h-5 text-pink-400"></i>
                        Exit Scenario Analysis
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-gray-700">
                                    <th class="text-left py-2 text-gray-400">Scenario</th>
                                    <th class="text-right py-2 text-gray-400">Exit Value</th>
                                    <th class="text-right py-2 text-gray-400">Return</th>
                                    <th class="text-right py-2 text-gray-400">MOIC</th>
                                    <th class="text-right py-2 text-gray-400">IRR</th>
                                    <th class="text-center py-2 text-gray-400">Grade</th>
                                </tr>
                            </thead>
                            <tbody id="scenarioTable">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let irrChart = null;
        let moicChart = null;

        // Format number with commas
        function formatNumber(num, decimals = 0) {
            return num.toFixed(decimals).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // Calculate IRR
        function calculateIRR(investment, cashReturn, years) {
            // Newton-Raphson method for IRR calculation
            let rate = 0.1;
            const tolerance = 0.0001;
            const maxIterations = 100;
            
            for (let i = 0; i < maxIterations; i++) {
                const npv = -investment + cashReturn / Math.pow(1 + rate, years);
                const dnpv = -years * cashReturn / Math.pow(1 + rate, years + 1);
                
                const newRate = rate - npv / dnpv;
                if (Math.abs(newRate - rate) < tolerance) {
                    return newRate;
                }
                rate = newRate;
            }
            return rate;
        }

        // Calculate returns
        function calculateReturns() {
            const investment = parseFloat(document.getElementById('investment').value);
            const preMoney = parseFloat(document.getElementById('preMoney').value);
            const exitMultiple = parseFloat(document.getElementById('exitMultiple').value);
            const currentRevenue = parseFloat(document.getElementById('currentRevenue').value);
            const growthRate = parseFloat(document.getElementById('growthRate').value) / 100;
            const exitYears = parseInt(document.getElementById('exitYears').value);
            const liquidation = document.getElementById('liquidation').value;
            
            // Calculate ownership
            const postMoney = preMoney + investment;
            const ownership = investment / postMoney;
            
            // Calculate exit revenue and value
            const exitRevenue = currentRevenue * Math.pow(1 + growthRate, exitYears);
            const exitValue = exitRevenue * exitMultiple;
            
            // Calculate returns based on liquidation preference
            let cashReturn = 0;
            if (liquidation === '1x') {
                cashReturn = Math.max(investment, exitValue * ownership);
            } else if (liquidation === '1xp') {
                cashReturn = investment + (exitValue - investment) * ownership;
            } else if (liquidation === '2x') {
                cashReturn = Math.max(investment * 2, exitValue * ownership);
            } else {
                cashReturn = exitValue * ownership;
            }
            
            const profit = cashReturn - investment;
            const moic = cashReturn / investment;
            const irr = calculateIRR(investment, cashReturn, exitYears) * 100;
            
            // Update metrics
            document.getElementById('exitValue').textContent = '$' + formatNumber(exitValue) + 'M';
            document.getElementById('exitRevenue').textContent = 'at $' + formatNumber(exitRevenue) + 'M revenue';
            document.getElementById('cashReturn').textContent = '$' + formatNumber(cashReturn) + 'M';
            document.getElementById('profit').textContent = '$' + formatNumber(profit) + 'M profit';
            document.getElementById('moic').textContent = moic.toFixed(1) + 'x';
            document.getElementById('irr').textContent = irr.toFixed(1) + '%';
            
            updateIRRChart(investment, preMoney, currentRevenue, growthRate, exitYears);
            updateMOICChart(investment, preMoney, exitMultiple, currentRevenue, growthRate);
            updateScenarioTable(investment, preMoney, currentRevenue, growthRate, exitYears);
        }

        // Update IRR chart
        function updateIRRChart(investment, preMoney, currentRevenue, growthRate, exitYears) {
            const ctx = document.getElementById('irrChart').getContext('2d');
            
            if (irrChart) {
                irrChart.destroy();
            }
            
            const multiples = [];
            const irrs = [];
            const ownership = investment / (preMoney + investment);
            
            for (let multiple = 2; multiple <= 20; multiple += 2) {
                multiples.push(multiple + 'x');
                const exitRevenue = currentRevenue * Math.pow(1 + growthRate, exitYears);
                const exitValue = exitRevenue * multiple;
                const cashReturn = exitValue * ownership;
                const irr = calculateIRR(investment, cashReturn, exitYears) * 100;
                irrs.push(irr);
            }
            
            irrChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: multiples,
                    datasets: [{
                        label: 'IRR %',
                        data: irrs,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'IRR: ' + context.parsed.y.toFixed(1) + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: { color: '#9CA3AF', font: { size: 10 } }
                        },
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: { 
                                color: '#9CA3AF',
                                font: { size: 10 },
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Update MOIC chart
        function updateMOICChart(investment, preMoney, exitMultiple, currentRevenue, growthRate) {
            const ctx = document.getElementById('moicChart').getContext('2d');
            
            if (moicChart) {
                moicChart.destroy();
            }
            
            const years = [];
            const moics = [];
            const ownership = investment / (preMoney + investment);
            
            for (let year = 2; year <= 10; year++) {
                years.push('Year ' + year);
                const exitRevenue = currentRevenue * Math.pow(1 + growthRate, year);
                const exitValue = exitRevenue * exitMultiple;
                const cashReturn = exitValue * ownership;
                const moic = cashReturn / investment;
                moics.push(moic);
            }
            
            moicChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'MOIC',
                        data: moics,
                        backgroundColor: 'rgba(168, 85, 247, 0.5)',
                        borderColor: '#a855f7',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'MOIC: ' + context.parsed.y.toFixed(1) + 'x';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: { color: '#9CA3AF', font: { size: 10 } }
                        },
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: { 
                                color: '#9CA3AF',
                                font: { size: 10 },
                                callback: function(value) {
                                    return value.toFixed(1) + 'x';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Update scenario table
        function updateScenarioTable(investment, preMoney, currentRevenue, growthRate, exitYears) {
            const scenarios = [
                { name: 'Bear Case', multipleAdj: 0.5, growthAdj: 0.7 },
                { name: 'Base Case', multipleAdj: 1.0, growthAdj: 1.0 },
                { name: 'Bull Case', multipleAdj: 1.5, growthAdj: 1.3 },
                { name: 'Home Run', multipleAdj: 2.5, growthAdj: 1.5 }
            ];
            
            const ownership = investment / (preMoney + investment);
            const baseMultiple = parseFloat(document.getElementById('exitMultiple').value);
            
            const tbody = document.getElementById('scenarioTable');
            tbody.innerHTML = scenarios.map(scenario => {
                const adjustedGrowth = growthRate * scenario.growthAdj;
                const adjustedMultiple = baseMultiple * scenario.multipleAdj;
                const exitRevenue = currentRevenue * Math.pow(1 + adjustedGrowth, exitYears);
                const exitValue = exitRevenue * adjustedMultiple;
                const cashReturn = exitValue * ownership;
                const moic = cashReturn / investment;
                const irr = calculateIRR(investment, cashReturn, exitYears) * 100;
                
                let grade, gradeColor;
                if (irr >= 30) {
                    grade = 'A+';
                    gradeColor = 'text-green-400';
                } else if (irr >= 20) {
                    grade = 'A';
                    gradeColor = 'text-emerald-400';
                } else if (irr >= 15) {
                    grade = 'B';
                    gradeColor = 'text-blue-400';
                } else if (irr >= 10) {
                    grade = 'C';
                    gradeColor = 'text-yellow-400';
                } else {
                    grade = 'D';
                    gradeColor = 'text-red-400';
                }
                
                return `
                    <tr class="border-b border-gray-800">
                        <td class="py-2">${scenario.name}</td>
                        <td class="text-right py-2">$${formatNumber(exitValue)}M</td>
                        <td class="text-right py-2 text-green-400">$${formatNumber(cashReturn)}M</td>
                        <td class="text-right py-2 text-purple-400">${moic.toFixed(1)}x</td>
                        <td class="text-right py-2 text-pink-400">${irr.toFixed(1)}%</td>
                        <td class="text-center py-2">
                            <span class="px-2 py-1 rounded text-xs ${gradeColor} bg-white/10 font-bold">${grade}</span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Run all scenarios
        function runScenarios() {
            calculateReturns();
            alert('All scenarios calculated! Review the charts and table for comprehensive analysis.');
        }

        // Export results
        function exportResults() {
            alert('In production, this would export to Excel with full IRR/MOIC analysis and scenario modeling.');
        }

        // Event listeners
        document.getElementById('exitMultiple').addEventListener('input', function() {
            document.getElementById('exitMultipleValue').textContent = this.value + 'x';
            calculateReturns();
        });

        document.getElementById('growthRate').addEventListener('input', function() {
            document.getElementById('growthRateValue').textContent = this.value + '%';
            calculateReturns();
        });

        document.getElementById('exitYears').addEventListener('input', function() {
            document.getElementById('exitYearsValue').textContent = this.value + ' years';
            calculateReturns();
        });

        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            calculateReturns();
        });
    </script>
</body>
</html>
