<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working Capital Optimization Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .glass-card {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .improvement { color: #10b981; }
        .deterioration { color: #ef4444; }
        .neutral { color: #6b7280; }
        .range-slider {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
        }
        .range-slider::-webkit-slider-track {
            background: rgba(59, 130, 246, 0.2);
            height: 6px;
            border-radius: 3px;
        }
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            background: #3b82f6;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            margin-top: -7px;
        }
        .metric-card {
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .optimization-item {
            transition: all 0.3s ease;
        }
        .optimization-item:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="glass-card rounded-xl p-6 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                <div>
                    <h1 class="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-teal-400 bg-clip-text text-transparent mb-2">
                        Working Capital Optimization
                    </h1>
                    <p class="text-gray-400">Real-time scenario modeling with cash impact analysis</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="text-right">
                        <div class="text-sm text-gray-400">Cash Release Potential</div>
                        <div id="cashRelease" class="text-2xl font-bold text-emerald-400">$0</div>
                    </div>
                    <button onclick="resetScenario()" class="px-4 py-2 bg-slate-700 text-gray-300 rounded-lg hover:bg-slate-600">
                        Reset
                    </button>
                </div>
            </div>

            <!-- Scenario Controls -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="text-sm text-gray-400 block mb-2">Industry Benchmark</label>
                    <select id="industrySelect" class="w-full bg-slate-800 text-white rounded-lg px-4 py-2 border border-gray-600">
                        <option value="saas">SaaS</option>
                        <option value="manufacturing">Manufacturing</option>
                        <option value="retail">Retail</option>
                        <option value="services">Professional Services</option>
                    </select>
                </div>
                <div>
                    <label class="text-sm text-gray-400 block mb-2">Optimization Goal</label>
                    <select id="goalSelect" class="w-full bg-slate-800 text-white rounded-lg px-4 py-2 border border-gray-600">
                        <option value="balanced">Balanced</option>
                        <option value="aggressive">Aggressive Cash Release</option>
                        <option value="conservative">Conservative Growth</option>
                    </select>
                </div>
                <div>
                    <label class="text-sm text-gray-400 block mb-2">Time Horizon</label>
                    <select id="horizonSelect" class="w-full bg-slate-800 text-white rounded-lg px-4 py-2 border border-gray-600">
                        <option value="30">30 Days</option>
                        <option value="60">60 Days</option>
                        <option value="90" selected>90 Days</option>
                        <option value="180">180 Days</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Cash Conversion Cycle Visualization -->
            <div class="lg:col-span-2 glass-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-200 mb-4">Cash Conversion Cycle Analysis</h3>
                <canvas id="cccChart" width="400" height="200"></canvas>
                
                <!-- Interactive Sliders -->
                <div class="mt-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-sm text-gray-400">Days Sales Outstanding (DSO)</label>
                            <span id="dsoValue" class="text-white font-semibold">45 days</span>
                        </div>
                        <input type="range" id="dsoSlider" class="range-slider w-full" min="20" max="90" value="45" step="1">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>20 days</span>
                            <span>Industry Avg: 42</span>
                            <span>90 days</span>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-sm text-gray-400">Days Inventory Outstanding (DIO)</label>
                            <span id="dioValue" class="text-white font-semibold">60 days</span>
                        </div>
                        <input type="range" id="dioSlider" class="range-slider w-full" min="15" max="120" value="60" step="1">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>15 days</span>
                            <span>Industry Avg: 55</span>
                            <span>120 days</span>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-sm text-gray-400">Days Payable Outstanding (DPO)</label>
                            <span id="dpoValue" class="text-white font-semibold">30 days</span>
                        </div>
                        <input type="range" id="dpoSlider" class="range-slider w-full" min="15" max="60" value="30" step="1">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>15 days</span>
                            <span>Industry Avg: 38</span>
                            <span>60 days</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics -->
            <div class="space-y-4">
                <div class="metric-card glass-card rounded-xl p-4">
                    <h3 class="text-sm text-gray-400 mb-2">Current CCC</h3>
                    <div id="currentCCC" class="text-3xl font-bold text-blue-400">75 days</div>
                    <div class="text-xs text-gray-500 mt-1">
                        <span id="cccTrend" class="improvement">â†“ 5 days vs last quarter</span>
                    </div>
                </div>
                
                <div class="metric-card glass-card rounded-xl p-4">
                    <h3 class="text-sm text-gray-400 mb-2">Working Capital</h3>
                    <div id="workingCapital" class="text-3xl font-bold text-purple-400">$5.2M</div>
                    <div class="text-xs text-gray-500 mt-1">
                        <span id="wcRatio">22% of revenue</span>
                    </div>
                </div>
                
                <div class="metric-card glass-card rounded-xl p-4">
                    <h3 class="text-sm text-gray-400 mb-2">Cash Impact</h3>
                    <div id="cashImpact" class="text-3xl font-bold text-emerald-400">$0</div>
                    <div class="text-xs text-gray-500 mt-1">
                        <span id="impactPercent">0% improvement</span>
                    </div>
                </div>
                
                <div class="metric-card glass-card rounded-xl p-4">
                    <h3 class="text-sm text-gray-400 mb-2">ROI of Changes</h3>
                    <div id="roi" class="text-3xl font-bold text-orange-400">0%</div>
                    <div class="text-xs text-gray-500 mt-1">
                        <span id="payback">Immediate payback</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Optimization Recommendations -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- AI-Powered Recommendations -->
            <div class="glass-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-200 mb-4">Optimization Opportunities</h3>
                <div id="recommendations" class="space-y-3">
                    <!-- Dynamic recommendations will be inserted here -->
                </div>
            </div>

            <!-- Component Analysis -->
            <div class="glass-card rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-200 mb-4">Component Breakdown</h3>
                <canvas id="componentChart" width="400" height="300"></canvas>
            </div>
        </div>

        <!-- Scenario Comparison -->
        <div class="glass-card rounded-xl p-6">
            <h3 class="text-lg font-semibold text-gray-200 mb-4">Scenario Impact Analysis</h3>
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="border-b border-gray-600">
                            <th class="text-left py-3 px-2 text-gray-300">Metric</th>
                            <th class="text-right py-3 px-2 text-gray-300">Current</th>
                            <th class="text-right py-3 px-2 text-gray-300">Optimized</th>
                            <th class="text-right py-3 px-2 text-gray-300">Change</th>
                            <th class="text-right py-3 px-2 text-gray-300">Annual Impact</th>
                        </tr>
                    </thead>
                    <tbody id="scenarioTable">
                        <!-- Dynamic content will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Financial data and constants
        const companyData = {
            revenue: 24000000, // Annual
            cogs: 8400000,
            currentAssets: 11500000,
            currentLiabilities: 6300000,
            receivables: 3000000,
            inventory: 1400000,
            payables: 700000
        };

        const industryBenchmarks = {
            saas: { dso: 42, dio: 0, dpo: 38 },
            manufacturing: { dso: 55, dio: 75, dpo: 45 },
            retail: { dso: 8, dio: 90, dpo: 40 },
            services: { dso: 65, dio: 5, dpo: 35 }
        };

        let cccChart = null;
        let componentChart = null;
        let originalValues = { dso: 45, dio: 60, dpo: 30 };

        function updateDashboard() {
            const dso = parseInt(document.getElementById('dsoSlider').value);
            const dio = parseInt(document.getElementById('dioSlider').value);
            const dpo = parseInt(document.getElementById('dpoSlider').value);
            
            // Update display values
            document.getElementById('dsoValue').textContent = dso + ' days';
            document.getElementById('dioValue').textContent = dio + ' days';
            document.getElementById('dpoValue').textContent = dpo + ' days';
            
            // Calculate CCC
            const ccc = dso + dio - dpo;
            const originalCCC = originalValues.dso + originalValues.dio - originalValues.dpo;
            
            document.getElementById('currentCCC').textContent = ccc + ' days';
            const cccChange = ccc - originalCCC;
            document.getElementById('cccTrend').textContent = 
                cccChange === 0 ? 'No change' :
                cccChange < 0 ? `â†“ ${Math.abs(cccChange)} days improvement` :
                `â†‘ ${cccChange} days deterioration`;
            document.getElementById('cccTrend').className = 
                cccChange === 0 ? 'neutral' :
                cccChange < 0 ? 'improvement' : 'deterioration';
            
            // Calculate cash impact
            const dailyRevenue = companyData.revenue / 365;
            const dailyCOGS = companyData.cogs / 365;
            
            const currentWC = (originalValues.dso * dailyRevenue) + 
                            (originalValues.dio * dailyCOGS) - 
                            (originalValues.dpo * dailyCOGS);
            
            const newWC = (dso * dailyRevenue) + 
                         (dio * dailyCOGS) - 
                         (dpo * dailyCOGS);
            
            const cashRelease = currentWC - newWC;
            
            document.getElementById('cashRelease').textContent = formatCurrency(cashRelease);
            document.getElementById('cashImpact').textContent = formatCurrency(cashRelease);
            document.getElementById('workingCapital').textContent = formatCurrency(newWC);
            document.getElementById('wcRatio').textContent = (newWC / companyData.revenue * 100).toFixed(1) + '% of revenue';
            document.getElementById('impactPercent').textContent = 
                cashRelease === 0 ? '0% improvement' :
                cashRelease > 0 ? (cashRelease / currentWC * 100).toFixed(1) + '% improvement' :
                Math.abs(cashRelease / currentWC * 100).toFixed(1) + '% increase';
            
            // Calculate ROI
            const implementationCost = Math.abs(cashRelease) * 0.05; // 5% implementation cost
            const annualBenefit = cashRelease * 0.06; // 6% cost of capital
            const roi = implementationCost > 0 ? (annualBenefit / implementationCost * 100) : 0;
            
            document.getElementById('roi').textContent = roi.toFixed(0) + '%';
            document.getElementById('payback').textContent = 
                roi > 0 ? (12 / (roi / 100)).toFixed(1) + ' months payback' : 'Immediate payback';
            
            // Update charts
            updateCCCChart(dso, dio, dpo);
            updateComponentChart(dso, dio, dpo);
            
            // Update recommendations
            updateRecommendations(dso, dio, dpo);
            
            // Update scenario table
            updateScenarioTable(dso, dio, dpo, cashRelease);
        }

        function formatCurrency(value) {
            const isNegative = value < 0;
            const absValue = Math.abs(value);
            
            if (absValue >= 1000000) {
                return (isNegative ? '-$' : '$') + (absValue / 1000000).toFixed(1) + 'M';
            } else if (absValue >= 1000) {
                return (isNegative ? '-$' : '$') + (absValue / 1000).toFixed(0) + 'k';
            } else {
                return (isNegative ? '-$' : '$') + absValue.toFixed(0);
            }
        }

        function updateCCCChart(dso, dio, dpo) {
            const ctx = document.getElementById('cccChart').getContext('2d');
            
            if (cccChart) {
                cccChart.destroy();
            }
            
            cccChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['DSO', 'DIO', 'DPO', 'Net CCC'],
                    datasets: [{
                        label: 'Current',
                        data: [dso, dio, -dpo, dso + dio - dpo],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(16, 185, 129, 0.8)'
                        ]
                    }, {
                        label: 'Industry Benchmark',
                        data: [
                            industryBenchmarks[document.getElementById('industrySelect').value].dso,
                            industryBenchmarks[document.getElementById('industrySelect').value].dio,
                            -industryBenchmarks[document.getElementById('industrySelect').value].dpo,
                            industryBenchmarks[document.getElementById('industrySelect').value].dso + 
                            industryBenchmarks[document.getElementById('industrySelect').value].dio - 
                            industryBenchmarks[document.getElementById('industrySelect').value].dpo
                        ],
                        backgroundColor: 'rgba(156, 163, 175, 0.3)',
                        borderColor: 'rgba(156, 163, 175, 1)',
                        borderWidth: 2,
                        type: 'line'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#9ca3af' }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#9ca3af',
                                callback: (value) => value + ' days'
                            },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#9ca3af' },
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function updateComponentChart(dso, dio, dpo) {
            const ctx = document.getElementById('componentChart').getContext('2d');
            
            if (componentChart) {
                componentChart.destroy();
            }
            
            const dailyRevenue = companyData.revenue / 365;
            const dailyCOGS = companyData.cogs / 365;
            
            componentChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Receivables', 'Inventory', 'Payables (Benefit)'],
                    datasets: [{
                        data: [
                            dso * dailyRevenue,
                            dio * dailyCOGS,
                            dpo * dailyCOGS
                        ],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af' }
                        },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    return context.label + ': ' + formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateRecommendations(dso, dio, dpo) {
            const recommendations = [];
            const industry = industryBenchmarks[document.getElementById('industrySelect').value];
            
            // DSO recommendations
            if (dso > industry.dso + 5) {
                recommendations.push({
                    title: 'Accelerate Collections',
                    impact: formatCurrency((dso - industry.dso) * companyData.revenue / 365),
                    actions: [
                        'Implement automated invoice reminders',
                        'Offer 2/10 net 30 early payment discounts',
                        'Enhance credit screening process'
                    ],
                    priority: 'high'
                });
            }
            
            // DIO recommendations
            if (dio > industry.dio + 10) {
                recommendations.push({
                    title: 'Optimize Inventory',
                    impact: formatCurrency((dio - industry.dio) * companyData.cogs / 365),
                    actions: [
                        'Implement just-in-time inventory',
                        'Enhance demand forecasting',
                        'Negotiate vendor-managed inventory'
                    ],
                    priority: 'medium'
                });
            }
            
            // DPO recommendations
            if (dpo < industry.dpo - 5) {
                recommendations.push({
                    title: 'Extend Payment Terms',
                    impact: formatCurrency((industry.dpo - dpo) * companyData.cogs / 365),
                    actions: [
                        'Renegotiate supplier payment terms',
                        'Implement supply chain financing',
                        'Optimize payment scheduling'
                    ],
                    priority: 'medium'
                });
            }
            
            // Add general optimization
            if (recommendations.length === 0) {
                recommendations.push({
                    title: 'Maintain Current Performance',
                    impact: 'Optimal',
                    actions: [
                        'Monitor KPIs weekly',
                        'Benchmark quarterly against peers',
                        'Automate reporting processes'
                    ],
                    priority: 'low'
                });
            }
            
            // Render recommendations
            const container = document.getElementById('recommendations');
            container.innerHTML = recommendations.map(rec => `
                <div class="optimization-item border border-gray-700 rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-semibold text-white">${rec.title}</h4>
                        <span class="text-xs px-2 py-1 rounded ${
                            rec.priority === 'high' ? 'bg-red-900/50 text-red-400' :
                            rec.priority === 'medium' ? 'bg-yellow-900/50 text-yellow-400' :
                            'bg-green-900/50 text-green-400'
                        }">${rec.priority.toUpperCase()}</span>
                    </div>
                    <div class="text-sm text-emerald-400 mb-2">Potential: ${rec.impact}</div>
                    <ul class="text-xs text-gray-400 space-y-1">
                        ${rec.actions.map(action => `<li>â€¢ ${action}</li>`).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function updateScenarioTable(dso, dio, dpo, cashRelease) {
            const tbody = document.getElementById('scenarioTable');
            const dailyRevenue = companyData.revenue / 365;
            const dailyCOGS = companyData.cogs / 365;
            
            const currentReceivables = originalValues.dso * dailyRevenue;
            const currentInventory = originalValues.dio * dailyCOGS;
            const currentPayables = originalValues.dpo * dailyCOGS;
            
            const newReceivables = dso * dailyRevenue;
            const newInventory = dio * dailyCOGS;
            const newPayables = dpo * dailyCOGS;
            
            const rows = [
                {
                    metric: 'Days Sales Outstanding',
                    current: originalValues.dso + ' days',
                    optimized: dso + ' days',
                    change: (dso - originalValues.dso) + ' days',
                    impact: formatCurrency((currentReceivables - newReceivables) * 12)
                },
                {
                    metric: 'Days Inventory Outstanding',
                    current: originalValues.dio + ' days',
                    optimized: dio + ' days',
                    change: (dio - originalValues.dio) + ' days',
                    impact: formatCurrency((currentInventory - newInventory) * 12)
                },
                {
                    metric: 'Days Payable Outstanding',
                    current: originalValues.dpo + ' days',
                    optimized: dpo + ' days',
                    change: (dpo - originalValues.dpo) + ' days',
                    impact: formatCurrency((newPayables - currentPayables) * 12)
                },
                {
                    metric: 'Cash Conversion Cycle',
                    current: (originalValues.dso + originalValues.dio - originalValues.dpo) + ' days',
                    optimized: (dso + dio - dpo) + ' days',
                    change: ((dso + dio - dpo) - (originalValues.dso + originalValues.dio - originalValues.dpo)) + ' days',
                    impact: formatCurrency(cashRelease * 0.06) // 6% cost of capital
                }
            ];
            
            tbody.innerHTML = rows.map(row => `
                <tr class="border-b border-gray-700">
                    <td class="py-2 px-2 text-gray-300">${row.metric}</td>
                    <td class="text-right py-2 px-2">${row.current}</td>
                    <td class="text-right py-2 px-2">${row.optimized}</td>
                    <td class="text-right py-2 px-2 ${
                        row.change.includes('-') ? 'improvement' : 
                        row.change === '0 days' ? 'neutral' : 'deterioration'
                    }">${row.change}</td>
                    <td class="text-right py-2 px-2 font-semibold">${row.impact}</td>
                </tr>
            `).join('');
        }

        function resetScenario() {
            document.getElementById('dsoSlider').value = originalValues.dso;
            document.getElementById('dioSlider').value = originalValues.dio;
            document.getElementById('dpoSlider').value = originalValues.dpo;
            updateDashboard();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            
            // Slider listeners
            document.getElementById('dsoSlider').addEventListener('input', updateDashboard);
            document.getElementById('dioSlider').addEventListener('input', updateDashboard);
            document.getElementById('dpoSlider').addEventListener('input', updateDashboard);
            
            // Select listeners
            document.getElementById('industrySelect').addEventListener('change', updateDashboard);
            document.getElementById('goalSelect').addEventListener('change', function() {
                const goal = this.value;
                const industry = industryBenchmarks[document.getElementById('industrySelect').value];
                
                if (goal === 'aggressive') {
                    document.getElementById('dsoSlider').value = Math.min(industry.dso - 5, 30);
                    document.getElementById('dioSlider').value = Math.min(industry.dio - 10, 30);
                    document.getElementById('dpoSlider').value = Math.min(industry.dpo + 10, 60);
                } else if (goal === 'conservative') {
                    document.getElementById('dsoSlider').value = industry.dso;
                    document.getElementById('dioSlider').value = industry.dio;
                    document.getElementById('dpoSlider').value = industry.dpo;
                }
                
                updateDashboard();
            });
        });
    </script>
</body>
</html>
