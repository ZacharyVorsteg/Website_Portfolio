<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Financial Dashboard - Dynamic Financial Statements</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0a0a;
            color: #e4e4e7;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(180deg, #111 0%, #0a0a0a 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            padding: 20px 40px;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .company-info h1 {
            font-size: 1.6rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 5px;
        }

        .company-info p {
            color: #6b7280;
            font-size: 0.9rem;
        }

        .period-selector {
            display: flex;
            gap: 10px;
        }

        .period-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #9ca3af;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .period-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }

        /* Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 30px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            padding: 12px 24px;
            color: #6b7280;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            font-weight: 500;
        }

        .tab.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Financial Statement */
        .statement {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .statement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .statement-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #fff;
        }

        .statement-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #9ca3af;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
            color: #fff;
        }

        /* Financial Table */
        .financial-table {
            width: 100%;
            border-collapse: collapse;
        }

        .financial-table th {
            text-align: left;
            padding: 12px;
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 500;
            border-bottom: 2px solid rgba(255, 255, 255, 0.08);
        }

        .financial-table th.amount {
            text-align: right;
        }

        .financial-table td {
            padding: 10px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
        }

        .financial-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        /* Line Item Styles */
        .line-item {
            font-weight: 400;
            color: #e4e4e7;
        }

        .line-item.category {
            font-weight: 600;
            color: #fff;
            cursor: pointer;
            user-select: none;
        }

        .line-item.category:hover {
            background: rgba(59, 130, 246, 0.05);
        }

        .line-item.subcategory {
            padding-left: 30px;
            color: #9ca3af;
            font-size: 0.95rem;
        }

        .line-item.total {
            font-weight: 700;
            color: #fff;
            background: rgba(59, 130, 246, 0.1);
            border-top: 2px solid rgba(59, 130, 246, 0.2);
            border-bottom: 2px solid rgba(59, 130, 246, 0.2);
        }

        .line-item.grand-total {
            font-weight: 700;
            font-size: 1.1rem;
            color: #fff;
            background: rgba(16, 185, 129, 0.1);
            border-top: 3px solid rgba(16, 185, 129, 0.3);
            border-bottom: 3px solid rgba(16, 185, 129, 0.3);
        }

        /* Amounts */
        .amount {
            text-align: right;
            font-family: 'SF Mono', 'Monaco', monospace;
        }

        .amount.positive {
            color: #10b981;
        }

        .amount.negative {
            color: #ef4444;
        }

        .amount.neutral {
            color: #e4e4e7;
        }

        /* Variance */
        .variance {
            text-align: right;
            font-size: 0.85rem;
        }

        .variance.favorable {
            color: #10b981;
        }

        .variance.unfavorable {
            color: #ef4444;
        }

        /* Expand/Collapse Arrow */
        .expand-arrow {
            display: inline-block;
            margin-right: 8px;
            transition: transform 0.2s;
        }

        .expand-arrow.collapsed {
            transform: rotate(-90deg);
        }

        /* Collapsible Rows */
        .collapsible-row {
            transition: all 0.3s ease;
        }

        .collapsible-row.hidden {
            display: none;
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
        }

        .kpi-label {
            font-size: 0.85rem;
            color: #6b7280;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .kpi-change {
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .kpi-change.positive {
            color: #10b981;
        }

        .kpi-change.negative {
            color: #ef4444;
        }

        /* Charts */
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }

        /* Grid Layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.05));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .info-box h3 {
            color: #3b82f6;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #e4e4e7;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="company-info">
                <h1>Executive Financial Dashboard Demo</h1>
                <p>Q4 2024 Financial Statements | Consolidated View</p>
            </div>
            <div class="period-selector">
                <button class="period-btn">Monthly</button>
                <button class="period-btn active">Quarterly</button>
                <button class="period-btn">Annual</button>
            </div>
        </div>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Info Box -->
        <div class="info-box">
            <h3>ðŸ“Š Interactive Financial Statements Demo</h3>
            <p>This demo showcases professional financial reporting with complete P&L, Balance Sheet, and Cash Flow statements. Click on category rows to expand/collapse details. All numbers are interconnected and follow proper accounting principles.</p>
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-label">Revenue</div>
                <div class="kpi-value">$142.8M</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> 12.4% YoY
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">EBITDA</div>
                <div class="kpi-value">$31.2M</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> 15.3% YoY
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Net Income</div>
                <div class="kpi-value">$18.7M</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> 8.2% YoY
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Operating Cash Flow</div>
                <div class="kpi-value">$28.4M</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> 22.1% YoY
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Gross Margin</div>
                <div class="kpi-value">40.8%</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> 2.3pp YoY
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Current Ratio</div>
                <div class="kpi-value">2.14</div>
                <div class="kpi-change positive">
                    <span>â†‘</span> Healthy
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('pl')">Income Statement</div>
            <div class="tab" onclick="switchTab('bs')">Balance Sheet</div>
            <div class="tab" onclick="switchTab('cf')">Cash Flow</div>
            <div class="tab" onclick="switchTab('board')">Board Deck</div>
        </div>

        <!-- Income Statement -->
        <div id="pl" class="tab-content active">
            <div class="statement">
                <div class="statement-header">
                    <h2 class="statement-title">Income Statement (P&L)</h2>
                    <div class="statement-actions">
                        <button class="btn" onclick="expandAll()">Expand All</button>
                        <button class="btn" onclick="collapseAll()">Collapse All</button>
                        <button class="btn" onclick="exportStatement()">Export</button>
                    </div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Line Item</th>
                            <th class="amount">Q4 2024</th>
                            <th class="amount">Q4 2023</th>
                            <th class="amount">Variance</th>
                            <th class="amount">% Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Revenue Section -->
                        <tr class="line-item category" onclick="toggleSection('revenue')">
                            <td><span class="expand-arrow" id="revenue-arrow">â–¼</span>Revenue</td>
                            <td class="amount positive">$142,800,000</td>
                            <td class="amount">$127,100,000</td>
                            <td class="amount positive">$15,700,000</td>
                            <td class="variance favorable">+12.4%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="revenue">
                            <td>Product Revenue</td>
                            <td class="amount">$98,500,000</td>
                            <td class="amount">$89,200,000</td>
                            <td class="amount positive">$9,300,000</td>
                            <td class="variance favorable">+10.4%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="revenue">
                            <td>Service Revenue</td>
                            <td class="amount">$32,100,000</td>
                            <td class="amount">$27,800,000</td>
                            <td class="amount positive">$4,300,000</td>
                            <td class="variance favorable">+15.5%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="revenue">
                            <td>Subscription Revenue</td>
                            <td class="amount">$12,200,000</td>
                            <td class="amount">$10,100,000</td>
                            <td class="amount positive">$2,100,000</td>
                            <td class="variance favorable">+20.8%</td>
                        </tr>

                        <!-- COGS Section -->
                        <tr class="line-item category" onclick="toggleSection('cogs')">
                            <td><span class="expand-arrow" id="cogs-arrow">â–¼</span>Cost of Goods Sold</td>
                            <td class="amount negative">($84,500,000)</td>
                            <td class="amount">($77,300,000)</td>
                            <td class="amount negative">($7,200,000)</td>
                            <td class="variance unfavorable">-9.3%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="cogs">
                            <td>Direct Materials</td>
                            <td class="amount negative">($42,300,000)</td>
                            <td class="amount">($38,100,000)</td>
                            <td class="amount negative">($4,200,000)</td>
                            <td class="variance unfavorable">-11.0%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="cogs">
                            <td>Direct Labor</td>
                            <td class="amount negative">($28,200,000)</td>
                            <td class="amount">($26,500,000)</td>
                            <td class="amount negative">($1,700,000)</td>
                            <td class="variance unfavorable">-6.4%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="cogs">
                            <td>Manufacturing Overhead</td>
                            <td class="amount negative">($14,000,000)</td>
                            <td class="amount">($12,700,000)</td>
                            <td class="amount negative">($1,300,000)</td>
                            <td class="variance unfavorable">-10.2%</td>
                        </tr>

                        <!-- Gross Profit -->
                        <tr class="line-item total">
                            <td>Gross Profit</td>
                            <td class="amount positive">$58,300,000</td>
                            <td class="amount">$49,800,000</td>
                            <td class="amount positive">$8,500,000</td>
                            <td class="variance favorable">+17.1%</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 30px; color: #6b7280;">Gross Margin %</td>
                            <td class="amount">40.8%</td>
                            <td class="amount">39.2%</td>
                            <td class="amount positive">1.6pp</td>
                            <td class="variance favorable">+4.1%</td>
                        </tr>

                        <!-- Operating Expenses -->
                        <tr class="line-item category" onclick="toggleSection('opex')">
                            <td><span class="expand-arrow" id="opex-arrow">â–¼</span>Operating Expenses</td>
                            <td class="amount negative">($27,100,000)</td>
                            <td class="amount">($24,200,000)</td>
                            <td class="amount negative">($2,900,000)</td>
                            <td class="variance unfavorable">-12.0%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="opex">
                            <td>Sales & Marketing</td>
                            <td class="amount negative">($12,400,000)</td>
                            <td class="amount">($10,800,000)</td>
                            <td class="amount negative">($1,600,000)</td>
                            <td class="variance unfavorable">-14.8%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="opex">
                            <td>Research & Development</td>
                            <td class="amount negative">($8,200,000)</td>
                            <td class="amount">($7,500,000)</td>
                            <td class="amount negative">($700,000)</td>
                            <td class="variance unfavorable">-9.3%</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="opex">
                            <td>General & Administrative</td>
                            <td class="amount negative">($6,500,000)</td>
                            <td class="amount">($5,900,000)</td>
                            <td class="amount negative">($600,000)</td>
                            <td class="variance unfavorable">-10.2%</td>
                        </tr>

                        <!-- EBITDA -->
                        <tr class="line-item total">
                            <td>EBITDA</td>
                            <td class="amount positive">$31,200,000</td>
                            <td class="amount">$25,600,000</td>
                            <td class="amount positive">$5,600,000</td>
                            <td class="variance favorable">+21.9%</td>
                        </tr>

                        <!-- D&A -->
                        <tr class="line-item">
                            <td style="padding-left: 30px;">Depreciation & Amortization</td>
                            <td class="amount negative">($5,800,000)</td>
                            <td class="amount">($5,200,000)</td>
                            <td class="amount negative">($600,000)</td>
                            <td class="variance unfavorable">-11.5%</td>
                        </tr>

                        <!-- EBIT -->
                        <tr class="line-item total">
                            <td>EBIT (Operating Income)</td>
                            <td class="amount positive">$25,400,000</td>
                            <td class="amount">$20,400,000</td>
                            <td class="amount positive">$5,000,000</td>
                            <td class="variance favorable">+24.5%</td>
                        </tr>

                        <!-- Other Income/Expenses -->
                        <tr class="line-item">
                            <td style="padding-left: 30px;">Interest Income</td>
                            <td class="amount positive">$800,000</td>
                            <td class="amount">$600,000</td>
                            <td class="amount positive">$200,000</td>
                            <td class="variance favorable">+33.3%</td>
                        </tr>
                        <tr class="line-item">
                            <td style="padding-left: 30px;">Interest Expense</td>
                            <td class="amount negative">($2,100,000)</td>
                            <td class="amount">($1,900,000)</td>
                            <td class="amount negative">($200,000)</td>
                            <td class="variance unfavorable">-10.5%</td>
                        </tr>
                        <tr class="line-item">
                            <td style="padding-left: 30px;">Other Income (Expense)</td>
                            <td class="amount positive">$300,000</td>
                            <td class="amount">($200,000)</td>
                            <td class="amount positive">$500,000</td>
                            <td class="variance favorable">+250.0%</td>
                        </tr>

                        <!-- EBT -->
                        <tr class="line-item total">
                            <td>Income Before Tax</td>
                            <td class="amount positive">$24,400,000</td>
                            <td class="amount">$18,900,000</td>
                            <td class="amount positive">$5,500,000</td>
                            <td class="variance favorable">+29.1%</td>
                        </tr>

                        <!-- Tax -->
                        <tr class="line-item">
                            <td style="padding-left: 30px;">Income Tax Expense (23%)</td>
                            <td class="amount negative">($5,700,000)</td>
                            <td class="amount">($4,600,000)</td>
                            <td class="amount negative">($1,100,000)</td>
                            <td class="variance unfavorable">-23.9%</td>
                        </tr>

                        <!-- Net Income -->
                        <tr class="line-item grand-total">
                            <td>Net Income</td>
                            <td class="amount positive">$18,700,000</td>
                            <td class="amount">$14,300,000</td>
                            <td class="amount positive">$4,400,000</td>
                            <td class="variance favorable">+30.8%</td>
                        </tr>

                        <!-- EPS -->
                        <tr>
                            <td style="padding-left: 30px; color: #6b7280;">Earnings Per Share (Basic)</td>
                            <td class="amount">$1.87</td>
                            <td class="amount">$1.43</td>
                            <td class="amount positive">$0.44</td>
                            <td class="variance favorable">+30.8%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Balance Sheet -->
        <div id="bs" class="tab-content">
            <div class="statement">
                <div class="statement-header">
                    <h2 class="statement-title">Balance Sheet</h2>
                    <div class="statement-actions">
                        <button class="btn" onclick="expandAll()">Expand All</button>
                        <button class="btn" onclick="collapseAll()">Collapse All</button>
                        <button class="btn" onclick="exportStatement()">Export</button>
                    </div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Account</th>
                            <th class="amount">Dec 31, 2024</th>
                            <th class="amount">Dec 31, 2023</th>
                            <th class="amount">Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Assets -->
                        <tr class="line-item category" onclick="toggleSection('current-assets')">
                            <td><span class="expand-arrow" id="current-assets-arrow">â–¼</span>Current Assets</td>
                            <td class="amount neutral">$142,300,000</td>
                            <td class="amount">$128,500,000</td>
                            <td class="amount positive">$13,800,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-assets">
                            <td>Cash & Cash Equivalents</td>
                            <td class="amount">$45,200,000</td>
                            <td class="amount">$38,100,000</td>
                            <td class="amount positive">$7,100,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-assets">
                            <td>Accounts Receivable</td>
                            <td class="amount">$38,400,000</td>
                            <td class="amount">$35,200,000</td>
                            <td class="amount positive">$3,200,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-assets">
                            <td>Inventory</td>
                            <td class="amount">$42,100,000</td>
                            <td class="amount">$40,800,000</td>
                            <td class="amount positive">$1,300,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-assets">
                            <td>Prepaid Expenses</td>
                            <td class="amount">$8,600,000</td>
                            <td class="amount">$7,400,000</td>
                            <td class="amount positive">$1,200,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-assets">
                            <td>Other Current Assets</td>
                            <td class="amount">$8,000,000</td>
                            <td class="amount">$7,000,000</td>
                            <td class="amount positive">$1,000,000</td>
                        </tr>

                        <!-- Non-Current Assets -->
                        <tr class="line-item category" onclick="toggleSection('noncurrent-assets')">
                            <td><span class="expand-arrow" id="noncurrent-assets-arrow">â–¼</span>Non-Current Assets</td>
                            <td class="amount neutral">$285,700,000</td>
                            <td class="amount">$267,200,000</td>
                            <td class="amount positive">$18,500,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-assets">
                            <td>Property, Plant & Equipment (Net)</td>
                            <td class="amount">$145,300,000</td>
                            <td class="amount">$138,200,000</td>
                            <td class="amount positive">$7,100,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-assets">
                            <td>Intangible Assets</td>
                            <td class="amount">$82,400,000</td>
                            <td class="amount">$78,000,000</td>
                            <td class="amount positive">$4,400,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-assets">
                            <td>Goodwill</td>
                            <td class="amount">$48,000,000</td>
                            <td class="amount">$42,000,000</td>
                            <td class="amount positive">$6,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-assets">
                            <td>Long-term Investments</td>
                            <td class="amount">$10,000,000</td>
                            <td class="amount">$9,000,000</td>
                            <td class="amount positive">$1,000,000</td>
                        </tr>

                        <!-- Total Assets -->
                        <tr class="line-item total">
                            <td>Total Assets</td>
                            <td class="amount neutral">$428,000,000</td>
                            <td class="amount">$395,700,000</td>
                            <td class="amount positive">$32,300,000</td>
                        </tr>

                        <!-- Liabilities -->
                        <tr class="line-item category" onclick="toggleSection('current-liabilities')">
                            <td><span class="expand-arrow" id="current-liabilities-arrow">â–¼</span>Current Liabilities</td>
                            <td class="amount neutral">$66,500,000</td>
                            <td class="amount">$62,100,000</td>
                            <td class="amount negative">$4,400,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-liabilities">
                            <td>Accounts Payable</td>
                            <td class="amount">$28,300,000</td>
                            <td class="amount">$26,500,000</td>
                            <td class="amount negative">$1,800,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-liabilities">
                            <td>Accrued Expenses</td>
                            <td class="amount">$18,200,000</td>
                            <td class="amount">$17,100,000</td>
                            <td class="amount negative">$1,100,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-liabilities">
                            <td>Short-term Debt</td>
                            <td class="amount">$12,000,000</td>
                            <td class="amount">$11,000,000</td>
                            <td class="amount negative">$1,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="current-liabilities">
                            <td>Current Portion of Long-term Debt</td>
                            <td class="amount">$8,000,000</td>
                            <td class="amount">$7,500,000</td>
                            <td class="amount negative">$500,000</td>
                        </tr>

                        <!-- Non-Current Liabilities -->
                        <tr class="line-item category" onclick="toggleSection('noncurrent-liabilities')">
                            <td><span class="expand-arrow" id="noncurrent-liabilities-arrow">â–¼</span>Non-Current Liabilities</td>
                            <td class="amount neutral">$85,000,000</td>
                            <td class="amount">$78,000,000</td>
                            <td class="amount negative">$7,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-liabilities">
                            <td>Long-term Debt</td>
                            <td class="amount">$65,000,000</td>
                            <td class="amount">$60,000,000</td>
                            <td class="amount negative">$5,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-liabilities">
                            <td>Deferred Tax Liabilities</td>
                            <td class="amount">$12,000,000</td>
                            <td class="amount">$11,000,000</td>
                            <td class="amount negative">$1,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="noncurrent-liabilities">
                            <td>Other Long-term Liabilities</td>
                            <td class="amount">$8,000,000</td>
                            <td class="amount">$7,000,000</td>
                            <td class="amount negative">$1,000,000</td>
                        </tr>

                        <!-- Total Liabilities -->
                        <tr class="line-item total">
                            <td>Total Liabilities</td>
                            <td class="amount neutral">$151,500,000</td>
                            <td class="amount">$140,100,000</td>
                            <td class="amount negative">$11,400,000</td>
                        </tr>

                        <!-- Equity -->
                        <tr class="line-item category" onclick="toggleSection('equity')">
                            <td><span class="expand-arrow" id="equity-arrow">â–¼</span>Shareholders' Equity</td>
                            <td class="amount neutral">$276,500,000</td>
                            <td class="amount">$255,600,000</td>
                            <td class="amount positive">$20,900,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="equity">
                            <td>Common Stock</td>
                            <td class="amount">$100,000,000</td>
                            <td class="amount">$100,000,000</td>
                            <td class="amount">$0</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="equity">
                            <td>Additional Paid-in Capital</td>
                            <td class="amount">$45,000,000</td>
                            <td class="amount">$43,000,000</td>
                            <td class="amount positive">$2,000,000</td>
                        </tr>
                        <tr class="line-item subcategory collapsible-row" data-section="equity">
                            <td>Retained Earnings</td>
                            <td class="amount">$131,500,000</td>
                            <td class="amount">$112,600,000</td>
                            <td class="amount positive">$18,900,000</td>
                        </tr>

                        <!-- Total Liabilities + Equity -->
                        <tr class="line-item grand-total">
                            <td>Total Liabilities & Equity</td>
                            <td class="amount neutral">$428,000,000</td>
                            <td class="amount">$395,700,000</td>
                            <td class="amount positive">$32,300,000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Cash Flow Statement -->
        <div id="cf" class="tab-content">
            <div class="statement">
                <div class="statement-header">
                    <h2 class="statement-title">Cash Flow Statement</h2>
                    <div class="statement-actions">
                        <button class="btn" onclick="exportStatement()">Export</button>
                    </div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Cash Flow Activity</th>
                            <th class="amount">Q4 2024</th>
                            <th class="amount">Q4 2023</th>
                            <th class="amount">Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Operating Activities -->
                        <tr class="line-item category">
                            <td>Operating Activities</td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Net Income</td>
                            <td class="amount positive">$18,700,000</td>
                            <td class="amount">$14,300,000</td>
                            <td class="amount positive">$4,400,000</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Depreciation & Amortization</td>
                            <td class="amount positive">$5,800,000</td>
                            <td class="amount">$5,200,000</td>
                            <td class="amount positive">$600,000</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Changes in Working Capital</td>
                            <td class="amount positive">$3,900,000</td>
                            <td class="amount">$2,100,000</td>
                            <td class="amount positive">$1,800,000</td>
                        </tr>
                        <tr class="line-item total">
                            <td>Net Cash from Operating Activities</td>
                            <td class="amount positive">$28,400,000</td>
                            <td class="amount">$21,600,000</td>
                            <td class="amount positive">$6,800,000</td>
                        </tr>

                        <!-- Investing Activities -->
                        <tr class="line-item category">
                            <td>Investing Activities</td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Capital Expenditures</td>
                            <td class="amount negative">($12,800,000)</td>
                            <td class="amount">($10,200,000)</td>
                            <td class="amount negative">($2,600,000)</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Acquisitions</td>
                            <td class="amount negative">($6,000,000)</td>
                            <td class="amount">$0</td>
                            <td class="amount negative">($6,000,000)</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Investments</td>
                            <td class="amount negative">($1,000,000)</td>
                            <td class="amount">($2,000,000)</td>
                            <td class="amount positive">$1,000,000</td>
                        </tr>
                        <tr class="line-item total">
                            <td>Net Cash from Investing Activities</td>
                            <td class="amount negative">($19,800,000)</td>
                            <td class="amount">($12,200,000)</td>
                            <td class="amount negative">($7,600,000)</td>
                        </tr>

                        <!-- Financing Activities -->
                        <tr class="line-item category">
                            <td>Financing Activities</td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                            <td class="amount"></td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Proceeds from Debt</td>
                            <td class="amount positive">$5,000,000</td>
                            <td class="amount">$8,000,000</td>
                            <td class="amount negative">($3,000,000)</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Debt Repayments</td>
                            <td class="amount negative">($4,500,000)</td>
                            <td class="amount">($4,000,000)</td>
                            <td class="amount negative">($500,000)</td>
                        </tr>
                        <tr class="line-item subcategory">
                            <td>Dividends Paid</td>
                            <td class="amount negative">($2,000,000)</td>
                            <td class="amount">($1,800,000)</td>
                            <td class="amount negative">($200,000)</td>
                        </tr>
                        <tr class="line-item total">
                            <td>Net Cash from Financing Activities</td>
                            <td class="amount negative">($1,500,000)</td>
                            <td class="amount">$2,200,000</td>
                            <td class="amount negative">($3,700,000)</td>
                        </tr>

                        <!-- Net Change -->
                        <tr class="line-item grand-total">
                            <td>Net Change in Cash</td>
                            <td class="amount positive">$7,100,000</td>
                            <td class="amount">$11,600,000</td>
                            <td class="amount negative">($4,500,000)</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 30px; color: #6b7280;">Beginning Cash Balance</td>
                            <td class="amount">$38,100,000</td>
                            <td class="amount">$26,500,000</td>
                            <td class="amount">$11,600,000</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 30px; color: #6b7280;">Ending Cash Balance</td>
                            <td class="amount">$45,200,000</td>
                            <td class="amount">$38,100,000</td>
                            <td class="amount positive">$7,100,000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Board Deck -->
        <div id="board" class="tab-content">
            <div class="statement">
                <div class="statement-header">
                    <h2 class="statement-title">Executive Board Presentation</h2>
                    <div class="statement-actions">
                        <button class="btn" onclick="presentMode()">Present Mode</button>
                        <button class="btn" onclick="exportDeck()">Export PDF</button>
                    </div>
                </div>

                <!-- Executive Summary -->
                <div style="background: rgba(59, 130, 246, 0.05); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h3 style="color: #3b82f6; margin-bottom: 15px;">Executive Summary</h3>
                    <div class="grid-2">
                        <div>
                            <h4 style="color: #fff; margin-bottom: 10px;">Key Achievements</h4>
                            <ul style="color: #e4e4e7; line-height: 1.8;">
                                <li>Revenue growth of 12.4% YoY to $142.8M</li>
                                <li>EBITDA margin improved to 21.9% (+2.3pp)</li>
                                <li>Net income increased 30.8% to $18.7M</li>
                                <li>Operating cash flow up 31.5% to $28.4M</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #fff; margin-bottom: 10px;">Strategic Initiatives</h4>
                            <ul style="color: #e4e4e7; line-height: 1.8;">
                                <li>Successful acquisition completed ($6M)</li>
                                <li>New product line launched in Q3</li>
                                <li>Operating efficiency program on track</li>
                                <li>Market share gains in key segments</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="grid-2">
                    <div class="statement">
                        <h3 style="margin-bottom: 15px;">Revenue Trend</h3>
                        <div class="chart-container">
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>
                    <div class="statement">
                        <h3 style="margin-bottom: 15px;">Profitability Metrics</h3>
                        <div class="chart-container">
                            <canvas id="profitChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Outlook -->
                <div class="statement">
                    <h3 style="margin-bottom: 15px;">FY 2025 Outlook</h3>
                    <table class="financial-table">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th class="amount">FY 2024 Actual</th>
                                <th class="amount">FY 2025 Guidance</th>
                                <th class="amount">Growth</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Revenue</td>
                                <td class="amount">$542.3M</td>
                                <td class="amount">$610M - $630M</td>
                                <td class="variance favorable">12-16%</td>
                            </tr>
                            <tr>
                                <td>EBITDA Margin</td>
                                <td class="amount">21.9%</td>
                                <td class="amount">23-24%</td>
                                <td class="variance favorable">+1-2pp</td>
                            </tr>
                            <tr>
                                <td>EPS</td>
                                <td class="amount">$7.12</td>
                                <td class="amount">$8.20 - $8.50</td>
                                <td class="variance favorable">15-19%</td>
                            </tr>
                            <tr>
                                <td>Free Cash Flow</td>
                                <td class="amount">$95M</td>
                                <td class="amount">$110M - $120M</td>
                                <td class="variance favorable">16-26%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab Switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        }

        // Toggle Section
        function toggleSection(section) {
            const rows = document.querySelectorAll(`[data-section="${section}"]`);
            const arrow = document.getElementById(`${section}-arrow`);
            
            rows.forEach(row => {
                row.classList.toggle('hidden');
            });
            
            arrow.classList.toggle('collapsed');
        }

        // Expand All
        function expandAll() {
            document.querySelectorAll('.collapsible-row').forEach(row => {
                row.classList.remove('hidden');
            });
            document.querySelectorAll('.expand-arrow').forEach(arrow => {
                arrow.classList.remove('collapsed');
            });
        }

        // Collapse All
        function collapseAll() {
            document.querySelectorAll('.collapsible-row').forEach(row => {
                row.classList.add('hidden');
            });
            document.querySelectorAll('.expand-arrow').forEach(arrow => {
                arrow.classList.add('collapsed');
            });
        }

        // Export functions
        function exportStatement() {
            alert('Exporting to Excel with full financial model...');
        }

        function exportDeck() {
            alert('Generating board presentation PDF...');
        }

        function presentMode() {
            alert('Entering presentation mode with speaker notes...');
        }

        // Initialize Charts
        const revenueCtx = document.getElementById('revenueChart');
        if (revenueCtx) {
            new Chart(revenueCtx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: '2024',
                        data: [128.5, 134.2, 138.7, 142.8],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }, {
                        label: '2023',
                        data: [115.2, 119.8, 123.4, 127.1],
                        borderColor: '#6b7280',
                        backgroundColor: 'rgba(107, 114, 128, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#9ca3af' }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: {
                                color: '#9ca3af',
                                callback: function(value) {
                                    return '$' + value + 'M';
                                }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }

        const profitCtx = document.getElementById('profitChart');
        if (profitCtx) {
            new Chart(profitCtx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Gross Margin', 'EBITDA Margin', 'Net Margin'],
                    datasets: [{
                        label: '2024',
                        data: [40.8, 21.9, 13.1],
                        backgroundColor: 'rgba(16, 185, 129, 0.8)'
                    }, {
                        label: '2023',
                        data: [39.2, 20.1, 11.3],
                        backgroundColor: 'rgba(107, 114, 128, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#9ca3af' }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: {
                                color: '#9ca3af',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
