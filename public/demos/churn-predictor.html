<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Churn Predictor - ML with ROC Curves</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .glass-card {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .risk-high { background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.1)); }
        .risk-medium { background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.1)); }
        .risk-low { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.1)); }
    </style>
</head>
<body class="text-gray-100 min-h-screen p-4 md:p-8">
    <!-- Header -->
    <div class="max-w-7xl mx-auto mb-8">
        <div class="glass-card rounded-xl p-6">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text text-transparent">
                    Customer Churn Predictor
                </h1>
                <span class="px-4 py-2 bg-red-500/20 text-red-400 rounded-lg text-sm font-medium">
                    Live Demo
                </span>
            </div>
            <p class="text-gray-400 mb-4">
                Machine learning model predicting customer churn using logistic regression. 
                Demonstrates feature importance analysis, ROC curves, and actionable risk scoring.
            </p>
            <div class="flex flex-wrap gap-2">
                <span class="px-3 py-1 bg-white/10 rounded-lg text-xs">Data Science</span>
                <span class="px-3 py-1 bg-white/10 rounded-lg text-xs">ML Classification</span>
                <span class="px-3 py-1 bg-white/10 rounded-lg text-xs">ROC Analysis</span>
                <span class="px-3 py-1 bg-white/10 rounded-lg text-xs">89% Accuracy</span>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto">
        <!-- Model Performance Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
            <div class="glass-card rounded-xl p-4">
                <div class="text-xs text-gray-400 mb-1">Accuracy</div>
                <div class="text-2xl font-bold text-emerald-400">89%</div>
            </div>
            <div class="glass-card rounded-xl p-4">
                <div class="text-xs text-gray-400 mb-1">Precision</div>
                <div class="text-2xl font-bold text-blue-400">87%</div>
            </div>
            <div class="glass-card rounded-xl p-4">
                <div class="text-xs text-gray-400 mb-1">Recall</div>
                <div class="text-2xl font-bold text-purple-400">85%</div>
            </div>
            <div class="glass-card rounded-xl p-4">
                <div class="text-xs text-gray-400 mb-1">F1 Score</div>
                <div class="text-2xl font-bold text-yellow-400">0.86</div>
            </div>
            <div class="glass-card rounded-xl p-4">
                <div class="text-xs text-gray-400 mb-1">AUC-ROC</div>
                <div class="text-2xl font-bold text-red-400">0.92</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Left Column -->
            <div class="space-y-6">
                <!-- Feature Importance -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="bar-chart-2" class="w-5 h-5 text-red-400"></i>
                        Feature Importance
                    </h3>
                    <canvas id="featureChart" height="200"></canvas>
                    <p class="text-xs text-gray-400 mt-4">
                        Top predictors of churn based on logistic regression coefficients. 
                        Customer engagement and support interactions are the strongest signals.
                    </p>
                </div>

                <!-- ROC Curve -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="trending-up" class="w-5 h-5 text-orange-400"></i>
                        ROC Curve Analysis
                    </h3>
                    <canvas id="rocChart" height="200"></canvas>
                    <div class="mt-4 p-3 bg-white/5 rounded-lg">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Area Under Curve (AUC):</span>
                            <span class="text-red-400 font-bold">0.92</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">
                            Excellent discrimination between churners and non-churners
                        </p>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="space-y-6">
                <!-- Customer Risk Table -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="users" class="w-5 h-5 text-yellow-400"></i>
                        High-Risk Customers (Live Predictions)
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-gray-700">
                                    <th class="text-left py-2 text-gray-400">Customer</th>
                                    <th class="text-right py-2 text-gray-400">Risk Score</th>
                                    <th class="text-center py-2 text-gray-400">Status</th>
                                    <th class="text-center py-2 text-gray-400">Action</th>
                                </tr>
                            </thead>
                            <tbody id="customerTable">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Confusion Matrix -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="grid-3x3" class="w-5 h-5 text-purple-400"></i>
                        Confusion Matrix
                    </h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div class="p-4 bg-emerald-500/20 rounded-lg">
                                <div class="text-3xl font-bold text-emerald-400">842</div>
                                <div class="text-xs text-gray-400 mt-1">True Negative</div>
                            </div>
                        </div>
                        <div class="text-center">
                            <div class="p-4 bg-red-500/20 rounded-lg">
                                <div class="text-3xl font-bold text-red-400">58</div>
                                <div class="text-xs text-gray-400 mt-1">False Positive</div>
                            </div>
                        </div>
                        <div class="text-center">
                            <div class="p-4 bg-orange-500/20 rounded-lg">
                                <div class="text-3xl font-bold text-orange-400">52</div>
                                <div class="text-xs text-gray-400 mt-1">False Negative</div>
                            </div>
                        </div>
                        <div class="text-center">
                            <div class="p-4 bg-blue-500/20 rounded-lg">
                                <div class="text-3xl font-bold text-blue-400">248</div>
                                <div class="text-xs text-gray-400 mt-1">True Positive</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Model Controls -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <i data-lucide="sliders" class="w-5 h-5 text-blue-400"></i>
                        Model Threshold
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="text-sm text-gray-400 mb-2 block">
                                Classification Threshold
                            </label>
                            <input type="range" id="threshold" min="0" max="100" value="50" 
                                   class="w-full h-2 rounded-lg bg-gradient-to-r from-red-500 to-orange-500">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>Conservative</span>
                                <span id="thresholdValue" class="text-red-400 font-bold">0.50</span>
                                <span>Aggressive</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-400">Predicted Churners:</span>
                                <span id="predictedChurners" class="float-right text-white">306</span>
                            </div>
                            <div>
                                <span class="text-gray-400">Save Rate Potential:</span>
                                <span id="saveRate" class="float-right text-emerald-400">45%</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="retrainModel()" class="w-full mt-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg transition-colors">
                        Retrain Model with New Data
                    </button>
                </div>
            </div>
        </div>

        <!-- Business Impact -->
        <div class="glass-card rounded-xl p-6 mt-6">
            <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                <i data-lucide="dollar-sign" class="w-5 h-5 text-green-400"></i>
                Business Impact Analysis
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="p-4 bg-white/5 rounded-lg">
                    <div class="text-xs text-gray-400 mb-1">Monthly Churn Rate</div>
                    <div class="text-xl font-bold text-red-400">5.2% → 3.1%</div>
                    <div class="text-xs text-emerald-400 mt-1">-40% reduction</div>
                </div>
                <div class="p-4 bg-white/5 rounded-lg">
                    <div class="text-xs text-gray-400 mb-1">Revenue Saved/Month</div>
                    <div class="text-xl font-bold text-emerald-400">$487K</div>
                    <div class="text-xs text-gray-500 mt-1">From retention</div>
                </div>
                <div class="p-4 bg-white/5 rounded-lg">
                    <div class="text-xs text-gray-400 mb-1">Intervention Cost</div>
                    <div class="text-xl font-bold text-orange-400">$82K</div>
                    <div class="text-xs text-gray-500 mt-1">Per month</div>
                </div>
                <div class="p-4 bg-white/5 rounded-lg">
                    <div class="text-xs text-gray-400 mb-1">ROI</div>
                    <div class="text-xl font-bold text-blue-400">494%</div>
                    <div class="text-xs text-gray-500 mt-1">Net positive</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Initialize charts
        let featureChart, rocChart;

        function initCharts() {
            // Feature Importance Chart
            const featureCtx = document.getElementById('featureChart').getContext('2d');
            featureChart = new Chart(featureCtx, {
                type: 'bar',
                data: {
                    labels: [
                        'Days Since Last Login',
                        'Support Tickets',
                        'Feature Usage',
                        'Payment Failures',
                        'Contract Length',
                        'Monthly Spend',
                        'User Seats',
                        'Integration Count'
                    ],
                    datasets: [{
                        label: 'Feature Importance',
                        data: [0.89, 0.76, 0.72, 0.68, 0.54, 0.48, 0.35, 0.28],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.6)',
                            'rgba(251, 146, 60, 0.6)',
                            'rgba(251, 191, 36, 0.6)',
                            'rgba(163, 230, 53, 0.6)',
                            'rgba(34, 197, 94, 0.6)',
                            'rgba(6, 182, 212, 0.6)',
                            'rgba(59, 130, 246, 0.6)',
                            'rgba(139, 92, 246, 0.6)'
                        ],
                        borderColor: [
                            '#ef4444',
                            '#fb923c',
                            '#fbbf24',
                            '#a3e635',
                            '#22c55e',
                            '#06b6d4',
                            '#3b82f6',
                            '#8b5cf6'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#9CA3AF' }
                        },
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#9CA3AF' }
                        }
                    }
                }
            });

            // ROC Curve
            const rocCtx = document.getElementById('rocChart').getContext('2d');
            
            // Generate ROC curve data
            const rocData = [];
            for (let i = 0; i <= 100; i++) {
                const fpr = i / 100;
                // Simulate a good ROC curve (AUC ~0.92)
                const tpr = Math.sqrt(fpr) * 0.95 + fpr * 0.05;
                rocData.push({ x: fpr, y: Math.min(tpr, 1) });
            }

            rocChart = new Chart(rocCtx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'ROC Curve (AUC = 0.92)',
                            data: rocData,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Random Classifier',
                            data: [{ x: 0, y: 0 }, { x: 1, y: 1 }],
                            borderColor: '#6b7280',
                            borderWidth: 1,
                            borderDash: [5, 5],
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#9CA3AF' }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'False Positive Rate',
                                color: '#9CA3AF'
                            },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#9CA3AF' }
                        },
                        y: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'True Positive Rate',
                                color: '#9CA3AF'
                            },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            ticks: { color: '#9CA3AF' }
                        }
                    }
                }
            });
        }

        // Generate customer table
        function generateCustomerTable() {
            const customers = [
                { name: 'Acme Corp', score: 0.92, days: 45, tickets: 8 },
                { name: 'TechStart Inc', score: 0.88, days: 38, tickets: 6 },
                { name: 'Global Systems', score: 0.85, days: 31, tickets: 5 },
                { name: 'DataFlow LLC', score: 0.79, days: 28, tickets: 4 },
                { name: 'CloudBase Pro', score: 0.76, days: 22, tickets: 3 },
                { name: 'NextGen Tech', score: 0.72, days: 18, tickets: 2 },
                { name: 'Digital Works', score: 0.68, days: 15, tickets: 2 },
                { name: 'Smart Solutions', score: 0.64, days: 12, tickets: 1 }
            ];

            const tbody = document.getElementById('customerTable');
            tbody.innerHTML = customers.map(customer => {
                const riskClass = customer.score >= 0.8 ? 'risk-high' : 
                                 customer.score >= 0.6 ? 'risk-medium' : 'risk-low';
                const riskLabel = customer.score >= 0.8 ? 'High' : 
                                 customer.score >= 0.6 ? 'Medium' : 'Low';
                const riskColor = customer.score >= 0.8 ? 'text-red-400' : 
                                 customer.score >= 0.6 ? 'text-yellow-400' : 'text-green-400';
                
                return `
                    <tr class="border-b border-gray-800">
                        <td class="py-2">
                            <div class="font-medium">${customer.name}</div>
                            <div class="text-xs text-gray-500">${customer.days} days inactive</div>
                        </td>
                        <td class="text-right py-2">
                            <div class="font-mono font-bold ${riskColor}">${(customer.score * 100).toFixed(0)}%</div>
                        </td>
                        <td class="text-center py-2">
                            <span class="px-2 py-1 rounded text-xs ${riskClass} ${riskColor}">
                                ${riskLabel}
                            </span>
                        </td>
                        <td class="text-center py-2">
                            <button class="px-3 py-1 bg-white/10 hover:bg-white/20 rounded text-xs transition-colors">
                                Intervene
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Update threshold
        document.getElementById('threshold').addEventListener('input', function() {
            const threshold = this.value / 100;
            document.getElementById('thresholdValue').textContent = threshold.toFixed(2);
            
            // Update predictions based on threshold
            const baseChurners = 306;
            const adjustment = (threshold - 0.5) * 200;
            const newChurners = Math.round(baseChurners - adjustment);
            document.getElementById('predictedChurners').textContent = newChurners;
            
            // Update save rate
            const saveRate = 45 - (threshold - 0.5) * 30;
            document.getElementById('saveRate').textContent = `${saveRate.toFixed(0)}%`;
        });

        // Retrain model simulation
        function retrainModel() {
            alert('In production, this would trigger a model retraining pipeline with the latest customer data, updating feature weights and improving predictions.');
        }

        // Initialize
        window.addEventListener('load', function() {
            initCharts();
            generateCustomerTable();
        });
    </script>
</body>
</html>
